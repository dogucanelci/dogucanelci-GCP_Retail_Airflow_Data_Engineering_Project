{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-03-02T09:23:59.494607Z", "invocation_id": "7be6853f-4152-4308-8893-e8a2d3f38970", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-02T09:23:41.923683Z", "completed_at": "2024-03-02T09:23:41.959714Z"}, {"name": "execute", "started_at": "2024-03-02T09:23:41.963991Z", "completed_at": "2024-03-02T09:23:45.629266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7136449813842773, "adapter_response": {"_message": "CREATE TABLE (4.4k rows, 10.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 4380, "bytes_processed": 11184389, "bytes_billed": 20971520, "location": "US", "project_id": "gcp-retail-data-eng-proj-no3", "job_id": "a2422c59-9c2f-4f32-8f3e-2eea47259eb0", "slot_ms": 5757}, "message": "CREATE TABLE (4.4k rows, 10.7 MiB processed)", "failures": null, "unique_id": "model.retail.dim_customer", "compiled": true, "compiled_code": "-- dim_customer.sql\n\n-- Create the dimension table\nWITH customer_cte AS (\n\tSELECT DISTINCT\n\t    to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n\t    Country AS country\n\tFROM `gcp-retail-data-eng-proj-no3`.`retail`.`raw_invoices`\n\tWHERE CustomerID IS NOT NULL\n)\nSELECT\n    t.*,\n\tcm.iso\nFROM customer_cte t\nLEFT JOIN `gcp-retail-data-eng-proj-no3`.`retail`.`country` cm ON t.country = cm.nicename", "relation_name": "`gcp-retail-data-eng-proj-no3`.`retail`.`dim_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-02T09:23:45.644225Z", "completed_at": "2024-03-02T09:23:45.656168Z"}, {"name": "execute", "started_at": "2024-03-02T09:23:45.660315Z", "completed_at": "2024-03-02T09:23:49.730575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.092146635055542, "adapter_response": {"_message": "CREATE TABLE (23.3k rows, 7.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 23260, "bytes_processed": 8117969, "bytes_billed": 10485760, "location": "US", "project_id": "gcp-retail-data-eng-proj-no3", "job_id": "d388532d-2474-45bb-8085-d88fb38c12ad", "slot_ms": 4995}, "message": "CREATE TABLE (23.3k rows, 7.7 MiB processed)", "failures": null, "unique_id": "model.retail.dim_datetime", "compiled": true, "compiled_code": "-- dim_datetime.sql\n\n-- Create a CTE to extract date and time components\nWITH datetime_cte AS (  \n  SELECT DISTINCT\n    InvoiceDate AS datetime_id,\n    CASE\n      WHEN LENGTH(InvoiceDate) = 16 THEN\n        -- Date format: \"DD/MM/YYYY HH:MM\"\n        PARSE_DATETIME('%m/%d/%Y %H:%M', InvoiceDate)\n      WHEN LENGTH(InvoiceDate) <= 14 THEN\n        -- Date format: \"MM/DD/YY HH:MM\"\n        PARSE_DATETIME('%m/%d/%y %H:%M', InvoiceDate)\n      ELSE\n        NULL\n    END AS date_part,\n  FROM `gcp-retail-data-eng-proj-no3`.`retail`.`raw_invoices`\n  WHERE InvoiceDate IS NOT NULL\n)\nSELECT\n  datetime_id,\n  date_part as datetime,\n  EXTRACT(YEAR FROM date_part) AS year,\n  EXTRACT(MONTH FROM date_part) AS month,\n  EXTRACT(DAY FROM date_part) AS day,\n  EXTRACT(HOUR FROM date_part) AS hour,\n  EXTRACT(MINUTE FROM date_part) AS minute,\n  EXTRACT(DAYOFWEEK FROM date_part) AS weekday\nFROM datetime_cte", "relation_name": "`gcp-retail-data-eng-proj-no3`.`retail`.`dim_datetime`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-02T09:23:49.772754Z", "completed_at": "2024-03-02T09:23:49.793197Z"}, {"name": "execute", "started_at": "2024-03-02T09:23:49.797155Z", "completed_at": "2024-03-02T09:23:53.400792Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6369094848632812, "adapter_response": {"_message": "CREATE TABLE (16.3k rows, 22.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 16282, "bytes_processed": 23656403, "bytes_billed": 24117248, "location": "US", "project_id": "gcp-retail-data-eng-proj-no3", "job_id": "71f187fe-eba2-4f0d-bf40-f6197c656faa", "slot_ms": 4972}, "message": "CREATE TABLE (16.3k rows, 22.6 MiB processed)", "failures": null, "unique_id": "model.retail.dim_product", "compiled": true, "compiled_code": "-- dim_product.sql\n-- StockCode isn't unique, a product with the same id can have different and prices\n-- Create the dimension table\nSELECT DISTINCT\n    to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n\t\tStockCode AS stock_code,\n    Description AS description,\n    UnitPrice AS price\nFROM `gcp-retail-data-eng-proj-no3`.`retail`.`raw_invoices`\nWHERE StockCode IS NOT NULL\nAND UnitPrice > 0", "relation_name": "`gcp-retail-data-eng-proj-no3`.`retail`.`dim_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-02T09:23:53.418263Z", "completed_at": "2024-03-02T09:23:53.440673Z"}, {"name": "execute", "started_at": "2024-03-02T09:23:53.444786Z", "completed_at": "2024-03-02T09:23:59.476558Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.0644850730896, "adapter_response": {"_message": "CREATE TABLE (397.9k rows, 50.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 397884, "bytes_processed": 52683969, "bytes_billed": 53477376, "location": "US", "project_id": "gcp-retail-data-eng-proj-no3", "job_id": "175fffb2-f52f-4472-9404-d3aaa2f1263b", "slot_ms": 12437}, "message": "CREATE TABLE (397.9k rows, 50.2 MiB processed)", "failures": null, "unique_id": "model.retail.fct_invoices", "compiled": true, "compiled_code": "-- fct_invoices.sql\n\n-- Create the fact table by joining the relevant keys from dimension table\nWITH fct_invoices_cte AS (\n    SELECT\n        InvoiceNo AS invoice_id,\n        InvoiceDate AS datetime_id,\n        to_hex(md5(cast(coalesce(cast(StockCode as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Description as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(UnitPrice as string), '_dbt_utils_surrogate_key_null_') as string))) as product_id,\n        to_hex(md5(cast(coalesce(cast(CustomerID as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(Country as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_id,\n        Quantity AS quantity,\n        Quantity * UnitPrice AS total\n    FROM `gcp-retail-data-eng-proj-no3`.`retail`.`raw_invoices`\n    WHERE Quantity > 0\n)\nSELECT\n    invoice_id,\n    dt.datetime_id,\n    dp.product_id,\n    dc.customer_id,\n    quantity,\n    total\nFROM fct_invoices_cte fi\nINNER JOIN `gcp-retail-data-eng-proj-no3`.`retail`.`dim_datetime` dt ON fi.datetime_id = dt.datetime_id\nINNER JOIN `gcp-retail-data-eng-proj-no3`.`retail`.`dim_product` dp ON fi.product_id = dp.product_id\nINNER JOIN `gcp-retail-data-eng-proj-no3`.`retail`.`dim_customer` dc ON fi.customer_id = dc.customer_id", "relation_name": "`gcp-retail-data-eng-proj-no3`.`retail`.`fct_invoices`"}], "elapsed_time": 19.14215898513794, "args": {"which": "run", "partial_parse": true, "use_colors": true, "use_colors_file": true, "enable_legacy_logger": false, "introspect": true, "log_path": "/usr/local/airflow/include/dbt/logs", "defer": false, "cache_selected_only": false, "version_check": true, "print": true, "log_level_file": "debug", "show_resource_report": false, "populate_cache": true, "vars": {}, "macro_debugging": false, "log_format": "default", "log_format_file": "debug", "write_json": true, "select": [], "profiles_dir": "/usr/local/airflow/include/dbt/", "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "favor_state": false, "printer_width": 80, "project_dir": "/usr/local/airflow/include/dbt", "log_level": "info", "invocation_command": "dbt run --profiles-dir /usr/local/airflow/include/dbt/", "quiet": false, "send_anonymous_usage_stats": true, "strict_mode": false, "static_parser": true, "indirect_selection": "eager", "exclude": []}}